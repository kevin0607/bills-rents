{
  "pluginType": "DB",
  "pluginId": "mysql-plugin",
  "unpublishedAction": {
    "name": "backup_query",
    "datasource": {
      "name": "MySQL",
      "pluginId": "mysql-plugin",
      "messages": [],
      "isAutoGenerated": false,
      "id": "MySQL",
      "deleted": false,
      "policies": [],
      "userPermissions": []
    },
    "pageId": "main",
    "actionConfiguration": {
      "timeoutInMillisecond": 10000,
      "paginationType": "NONE",
      "encodeParamsToggle": true,
      "body": "\n\nselect su.submeter_id,\nsu.main_meter_id,\nABS(SUBSTRING_INDEX(group_concat(distinct su.meter_reading), ',', 1) - SUBSTRING_INDEX(group_concat(distinct su.meter_reading), ',', -1)) sub_meter_units,\ngroup_concat(distinct CASE WHEN  mm.month_year=DATE_FORMAT(NOW(), '%Y%m')  THEN mm.meter_reading ELSE NULL END) latest_bill ,\ngroup_concat(distinct CASE WHEN  mm.month_year=DATE_FORMAT(NOW(), '%Y%m')  THEN mm.units_consumed ELSE NULL END) units_consumed , \nROUND((group_concat(distinct CASE WHEN  mm.month_year=DATE_FORMAT(NOW(), '%Y%m')  THEN mm.meter_reading ELSE NULL END)/group_concat(distinct CASE WHEN  mm.month_year=DATE_FORMAT(NOW(), '%Y%m')  THEN mm.units_consumed ELSE NULL END))*ABS(SUBSTRING_INDEX(group_concat(distinct su.meter_reading), ',', 1) - SUBSTRING_INDEX(group_concat(distinct su.meter_reading), ',', -1)),1) sub_meter_bill ,\n(group_concat(distinct CASE WHEN  mm.month_year=DATE_FORMAT(NOW(), '%Y%m')  THEN mm.units_consumed ELSE NULL END) - ABS(SUBSTRING_INDEX(group_concat(distinct su.meter_reading), ',', 1) - SUBSTRING_INDEX(group_concat(distinct su.meter_reading), ',', -1))) main_meter_units,\nROUND((group_concat(distinct CASE WHEN  mm.month_year=DATE_FORMAT(NOW(), '%Y%m')  THEN mm.meter_reading ELSE NULL END)/group_concat(distinct CASE WHEN  mm.month_year=DATE_FORMAT(NOW(), '%Y%m')  THEN mm.units_consumed ELSE NULL END))*(group_concat(distinct CASE WHEN  mm.month_year=DATE_FORMAT(NOW(), '%Y%m')  THEN mm.units_consumed ELSE NULL END) - ABS(SUBSTRING_INDEX(group_concat(distinct su.meter_reading), ',', 1) - SUBSTRING_INDEX(group_concat(distinct su.meter_reading), ',', -1))),1) main_meter_bill\nfrom submeters su join main_meters mm on mm.submeter_id=su.submeter_id and mm.meter_id=su.main_meter_id where mm.month_year >= DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 1 MONTH), '%Y%m') and su.month_year >= DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 1 MONTH), '%Y%m') group by 1,2;\n",
      "selfReferencingDataPaths": [],
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ]
    },
    "executeOnLoad": false,
    "dynamicBindingPathList": [],
    "isValid": true,
    "invalids": [],
    "messages": [],
    "jsonPathKeys": [],
    "userSetOnLoad": false,
    "confirmBeforeExecute": false,
    "policies": [],
    "userPermissions": [],
    "createdAt": "2023-07-11T12:34:37Z"
  },
  "id": "main_backup_query",
  "deleted": false,
  "gitSyncId": "64ab1361f97f0f1342b5fcd4_64ad4c5dfd2ee65af306b6f1"
}