{
  "pluginType": "DB",
  "pluginId": "mysql-plugin",
  "unpublishedAction": {
    "name": "get_info",
    "datasource": {
      "name": "Untitled datasource 1",
      "pluginId": "mysql-plugin",
      "messages": [],
      "isAutoGenerated": false,
      "id": "Untitled datasource 1",
      "deleted": false,
      "policies": [],
      "userPermissions": []
    },
    "pageId": "main",
    "actionConfiguration": {
      "timeoutInMillisecond": 10000,
      "paginationType": "NONE",
      "encodeParamsToggle": true,
      "body": "SELECT\n    m1.meter_id,\n    m1.submeter_id,\n    m1.meter_reading_cost,\n    m1.units_consumed,\n    m1.month_year,\n    m1.sub_meter_reading,\n    t1.Name AS sub_meter_tenant_name,\n    t1.Phone_no AS sub_meter_tenant_phone,\n    t1.floor_no AS sub_meter_tenant_floor_no,\n    t2.Name AS main_meter_tenant_name,\n    t2.Phone_no AS main_meter_tenant_phone,\n    t2.floor_no AS main_meter_tenant_floor_no,\n    (m1.sub_meter_reading - COALESCE(m2.sub_meter_reading, 0)) AS sub_meter_units,\n    m1.units_consumed - (m1.sub_meter_reading - COALESCE(m2.sub_meter_reading, 0)) AS main_meter_units,\n    m1.meter_reading_cost / m1.units_consumed AS cost_per_unit,\n    ROUND((m1.sub_meter_reading - COALESCE(m2.sub_meter_reading, 0)) * (m1.meter_reading_cost / m1.units_consumed), 1) AS sub_meter_cost,\n    ROUND((m1.units_consumed - (m1.sub_meter_reading - COALESCE(m2.sub_meter_reading, 0))) * (m1.meter_reading_cost / m1.units_consumed), 1) AS main_meter_cost\nFROM\n    main_meters AS m1\nLEFT JOIN\n    main_meters AS m2 ON SUBSTRING(m2.month_year, 1, 6) = SUBSTRING(m1.month_year, 1, 6) - 1\n    AND m2.meter_id = m1.meter_id\n    AND m2.submeter_id = m1.submeter_id\nLEFT JOIN\n    tenants AS t1 ON t1.tenant_meter_id = m1.submeter_id\nLEFT JOIN\n    tenants AS t2 ON t2.tenant_meter_id = m1.meter_id\nWHERE\n    m1.month_year = DATE_FORMAT(CURDATE(), '%Y%m')\nORDER BY\n    m1.month_year;\n",
      "selfReferencingDataPaths": [],
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ]
    },
    "executeOnLoad": true,
    "dynamicBindingPathList": [],
    "isValid": true,
    "invalids": [],
    "messages": [],
    "jsonPathKeys": [],
    "userSetOnLoad": false,
    "confirmBeforeExecute": false,
    "policies": [],
    "userPermissions": [],
    "createdAt": "2023-07-09T22:27:41Z"
  },
  "id": "main_get_info",
  "deleted": false,
  "gitSyncId": "64ab1361f97f0f1342b5fcd4_64ab345d6437255cd869f504"
}